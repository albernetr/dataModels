# Alert data model

## Description
This entity models an alert generated by a user in a givel location. This models could be used to send alerts related to traffic jam, accidents, weather conditions, high level of pollutants and so on. 
The objective of this model is to define all the data that will send to Orion Context Broker. Then, an application could suscribe to OCB and to take these informaion and to generate notifications for a user or trigger other actions.

## Alert definition
Alerts are context data generated by final users (humans) or devices, such as smartphones or software apps. Also, a Smart Spot or Cloudino could send alerts if these technologies can incorporate some type of processing device that could process data and to  determine if the data contains some data to be communicated to users. For instance, a Smart Spot could produces an alert about high levels of Ozone and in the same way the Cloudino could send alerts of strong raining to users. 

An alert is generated by a specific situation that trigger an alert. The main features of an alert is that it is not predictable and it is not a recurrent data. That means that an alert could be an accident or a high level of pollutants measure, additionally it could be the fall down of a patient or a car driving in the opposite direction.

When a user or device detects an irregular situation sends an alert to a set of users. The context data around the alert are send to the Orion Context Broker according a specific data model. Some examples of context data are: type of alert (traffic, suspicious activities, and pollution, etc.), severity, location and so on. 

A set of alerts have been detected for the project scenarios:

| Smart city  | Smart security | Smart health |
| ------------- | ------------- |------------- |
| Traffic jam  | A car in opposite direction  |Fall of a patient |
| Accident cars  | When a car suddenly stops  |Bump of a patient |
| Weather condition  | Suspicious activities  | |
| High level of pollution  | Assaults |------------- |
| Pollen |------------- |------------- |
| Asthma attacks |-------------|------------- |


## Data model

A JSON Schema corresponding to this data model can be found [JSON Schema] 
(https://github.com/smartsdk/dataModels/blob/master/UserDataModels/datamodels/User%20event%20entity/UserEventEntityJsonSchema.json)

+ `id` : Entity's unique identifier. 

+ `type` : Entity type. It must be equal to `Alert`.

+ `alertType` : Define the type of alert (Traffic jam, accidents, weather conditions, high level of pollutants)
	+ Attribute type: text
    + Normative References: [https://schema.org/Event](https://schema.org/Event)
    + Mandatory 

+ `eventObserved` : Describe the subtype of alerts (Alert: Traffic jam, Subtypes of alerts: Standstill Traffic Jam, Heavy Traffic Jam,  Car Stopped On Road, and so on).
	 + Attribute type: text
	 + Normative References: [https://schema.org/subEvent](https://schema.org/subEvent)
	 + Mandatory	
	
+ `location` : Location of alert represented by a GeoJSON geometry. 
    + Attribute type: `geo:json`.
    + Normative References: [https://tools.ietf.org/html/rfc7946](https://tools.ietf.org/html/rfc7946)
    + Mandatory

+ `address` : Civic address of `Alert`
    + Normative References: [https://schema.org/address](https://schema.org/address)
    + Mandatory if `location` is not present.
	
+ `dateTime` : The date and time of this alert in ISO8601 UTCformat. It can be represented by an specific time instant or by an ISO8601 interval.
	+ Attribute type: DateTime or an ISO8601 interval represented as Text.
	+ Mandatory

+ `description` : A description of alert (Traffic jam in Paseo de la Reforma. Emergency services at place).
	 + Attribute type: text
	 + Normative References: [https://schema.org/description](https://schema.org/description)
	 + Optional	 
	 
+ `refUser` : reference to the User that generated an alert. Within FIWARE, this reference could point to the end of the FIWARE Identity Manager, where FIWARE user profiles are stored.
    + Attribute type: `string`
    + Mandatory	if `refDevice` is not present.

+ `refDevice` : reference to device that generate an alert.
    + Attribute type: `string`
    + Mandatory	if `refUser` is not present.
	
	
## Examples of use
{
		"id": "Alert:1",
		"type": "Alert",
		"alertType": "Weather condition",
		"eventObserved": "Heat wave",
		"location": {
			"type": "feature",
			"coordinates": [-3.712247222222222, 40.423852777777775]
		},
	
		"dateTime": "2017-01-02T09:25:55.00Z",
		"description": "Extreme danger: heat stroke is imminent.",
		"refuser":"",
		"refDevice": "Device1"
}  
  
## Use it with a real service
T.B.D

## Open Issues
T.B.D
